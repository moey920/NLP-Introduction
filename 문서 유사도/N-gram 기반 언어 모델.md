# N-gram 기반 언어 모델

> **언어 모델**이란? 주어진 문장이 텍스트 데이터에서 발생할 확률을 계산하는 모델

- 얼마나 실제로 발생가능한 문장인지 확률을 계산한다.
```
문장 1 : 포근한 | 봄 | 날씨가 | 이어질 | 것으로 | 전망됩니다.

텍스트 데이터, P(문장) = 0.233
```

- 언어 모델을 통해 자동 문장 생성이 가능
    - 포털에서 검색 시 가장 적합한 문장을 자동완성해주는 기능
    - toyscript(https://toyscript.azurewebsites.net/) 웹 서비스에서 영화 타이틀 자동 완성 기능으로 사용해보기!

- 챗봇 내 핵심 요소 중 하나(확률값 기반 문장 생성)
- 문장의 발생 확률은 **단어가 발생할 조건부 확률의 곱**으로 계산
    ```
    문장 1 : 포근한 | 봄 | 날씨가 | 이어질 | 것으로 | 전망됩니다.

    P(문장) = P(포근한) × P(봄|포근한) × P(날씨가|포근한, 봄) × P(이어질|포근한, 봄, 날씨가) × … × P(전망됩니다|포근한, 봄, 날씨가, 이어질, 것으로)
    ```
- **N-gram**을 사용하여 **단어의 조건부 확률을 근사**
    - 오래된 단어보다는 최근 단어가 현재 단어를 생성할 확률에 큰 영향을 미친다는 가정
    - 계산량이 줄어들고 정확 근사도가 향상된다.
    ```
    문장 1 : 포근한 | 봄 | 날씨가 | 이어질 | 것으로 | 전망됩니다.

    [Tri-gram 기준= P(문장) ≈ P(날씨가|포근한, 봄) × P(이어질|봄, 날씨가) × … × P(전망됩니다|이어질, 것으로)
    ```
    - 각 N-gram 기반 조건부 확률은 데이터 내 **각 n-gram의 빈도수**로 계산
    ```
    P(날씨가|포근한, 봄) = 전체 데이터 내 "포근한 봄 날씨가" 의 빈도수 / 전체 데이터에서 "포근한 봄"의 빈도수
    ```
- 문장 생성 시, 주어진 단어 기준 **최대 조건부 확률**의 단어를 다음 단어로 생성
    ```
    생성되는 문장 : 무더운 | 여름 | ?

    P(엘리스 | 여름) = 0.02
    P(여름 | 바다) = 0.5
    P(날씨 | 무더운, 여름) = 0.87
    따라서 다음 단어로 '날씨'를 선택하여 '무더운 여름 날씨' 가 생성된다.
    …

